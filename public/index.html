<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="../../favicon.ico">
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="font-awesome-4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//rawgithub.com/Caged/d3-tip/master/examples/example-styles.css">
    <link rel="stylesheet" href="css/main.css">

    <title>Strona główna</title>
</head>

<body>

<script src="js/jquery-3.1.0.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="js/remove-diacritics.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="js/collaboration-graph.js"></script>
<script src="js/d3-tip.js"></script>
<script src="js/parse-raw-expertus.js"></script>
<script src="js/collab-demo-1.js"></script>
<script src="js/bar-graph.js"></script>
<script src="js/works-over-time-demo-1.js"></script>
<script src="js/expertus-retriever.js"></script>


<nav>
    <div class="nav-wrapper">
        <a href="#" class="brand-logo">Wizualizator naukowca</a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li><a href="index.html">Wizualizacje</a></li>
        </ul>
    </div>
</nav>

<div class="row">
    <div class="col s4">
<div class="z-depth-1 vis-select ">
    <div class="row" hidden="hidden">
        <div class="card file-input-card">
            <div class="card-content black-text file-input-container">
                <span class="card-title"> Dane wejściowe</span>
                <p>prześlij plik z bazy ekspertus, na podstawie ktorego strona wygeneruje wizualizacje</p>
                <form action="#" id="file-input-form">
                    <div class="file-field input-field">
                        <div class="btn">
                            <span>Plik</span>
                            <input type="file" id="file-input">
                        </div>
                        <div class="file-path-wrapper">
                            <input class="file-path validate" type="text">
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="card name-input-card col s12">
            <div class="card-content black-text">
                <span class="card-title">Imię i nazwisko</span>
                <p>Podaj swoje imię i nazwisko, a aplikacja przeszuka bazę Ekspertus za Ciebie</p>
                <form action="#" id="name-input-form">
                    <div>
                        <div class="row">
                            <div class="input-field col s6">
                                <input placeholder="Imię" type="text" name="name" title="name">
                            </div>
                            <div class="input-field col s6">
                                <input placeholder="Nazwisko" type="text" name="surname" title="surname">
                            </div>
                        </div>

                        <input class="btn" type="submit">
                    </div>
                </form>
            </div>

        </div>
    </div>
    <div class="row" hidden="hidden">
        <div class="card name-select-card" id="name-select-card" hidden="hidden">
            <form action="#" id="name-select-form">
                <ul class="collection with-header" id="name-select-list">
                    <li class="collapsible-header" id="name-select-list-header" style="font-size: xx-large">
                        Zaznacz na liscie swoje imie
                    </li>

                </ul>
                <button class="btn waves-effect" type="submit" id="name-select-submit">
                    Wybierz
                </button>
            </form>
        </div>

    </div>
    <div class ="row" hidden="hidden">
        <div class="card">
            <div class="card-content white-text">
                <span class="card-title">Graf współautorstwa</span>
                <p>Symulacja, w której każda osoba oznaczona we wczytanej pracy jako współautor jest przedstawiona jako węzeł, który przyciągany jest do innych tym silniej, im więcej dzieli z nimi prac naukowych</p>
            </div>
            <div class="card-action">
                <a class="btn waves-effect waves-light disabled vis-select-btn" onclick="drawSimulationCollaborationGraph(parsedData.collaboration)" href="#">Wyświetl</a>
                <a class="btn waves-effect waves-light demo" onclick="toggleCollabDemo()" href="#">Demo</a>
            </div>
        </div>
    </div>
    <div class ="row" hidden="hidden">
        <div class="card ">
            <div class="card-content white-text">
                <span class="card-title">Prace w czasie</span>
                <p>Zestawienie liczby publikacji na osi Oy wraz z rokiem publikacji na osi Ox, z wyszczególnieniem artykułów oraz książek.</p>
            </div>
            <div class="card-action">
                <a class="btn waves-effect waves-light disabled vis-select-btn" onclick="drawWorksOverTimeGraph(parsedData.worksOverTime)" href="#">Wyświetl</a>
                <a class="btn waves-effect waves-light demo" onclick="drawWorksOverTimeGraph(WorksDemo())" href="#">Demo</a>
            </div>
        </div>
    </div>
</div>
    </div>
    <div class="col s8" style="margin-top: 50px">
        <div class="select-cards-container" >
            <div class="row" id="row1">
                <div class="col s6" id="row1col1">
                    <div class="card white-text" style="margin-bottom: 50px">
                        <div class="card-image">
                            <img src="images/works-thumb.png">
                            <span class="card-title black-text">Prace w czasie</span>
                        </div>
                        <div style="padding: 10px; height: 100px" class="card-content">
                            <p>Zestawienie liczby publikacji na osi Oy wraz z rokiem publikacji na osi Ox, z wyszczególnieniem artykułów oraz książek.</p>
                        </div>
                        <div class="card-action">
                            <form action="works" method="post" enctype="application/x-www-form-urlencoded">
                                <input name="name" value="TestName" class="vis-form-name-input" hidden="hidden">
                                <input type="submit" class="btn waves-effect waves-light vis-redirect" disabled>
                            </form>
                        </div>
                    </div>
                    <div class="card white-text">
                        <div class="card-image">
                            <img src="">
                            <span class="card-title black-text">Kolo dziedzin</span>
                        </div>
                        <div style="padding: 10px; height: 100px" class="card-content">
                            <p>Krotki opis kola dziedzin</p>
                        </div>
                        <div class="card-action">
                            <form action="research-map" method="post" enctype="application/x-www-form-urlencoded">
                                <input name="name" value="TestName" class="vis-form-name-input" hidden="hidden">
                                <input type="submit" class="btn waves-effect waves-light vis-redirect">
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col s6" id="row1col2">
                    <div class="card white-text">
                        <div class="card-image">
                            <img src="images/collab-thumb.png">
                            <span class="card-title black-text">Graf współpracy</span>
                        </div>
                        <div style="padding: 10px; height: 100px" class="card-content">
                            <p>Symulacja, w której każda osoba oznaczona we wczytanej pracy jako współautor jest przedstawiona jako węzeł, który przyciągany jest do innych tym silniej, im więcej dzieli z nimi prac naukowych</p>
                        </div>
                        <div class="card-action">
                            <form action="collab" method="post" enctype="application/x-www-form-urlencoded">
                                <input name="name" value="TestName" class="vis-form-name-input" hidden="hidden">
                                <input type="submit" class="btn waves-effect waves-light vis-redirect" disabled>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col s6" id="row2col2">
                    <div class="card white-text">
                        <div class="card-image">
                            <img src="images/bubbles-thumb.png">
                            <span class="card-title black-text">Graf bąbelkowy</span>
                        </div>
                        <div style="padding: 10px; height: 100px" class="card-content">
                            <p>Krótki opis grafu bąbelkowego</p>
                        </div>
                        <div class="card-action">
                            <form action="bubbles" method="post" enctype="application/x-www-form-urlencoded">
                                <input name="name" value="TestName" class="vis-form-name-input" hidden="hidden">
                                <input type="submit" class="btn waves-effect waves-light vis-redirect" disabled>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col s6" id="row2col1">

                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {

    var selectForm = $('#name-select-form');
    selectForm.submit(function (event) {
        event.preventDefault();
        var trueName = $('label[for="' + $('input[type="radio"]:checked').attr("id") + '"]').text();
        $('.vis-form-name-input').val(trueName);
        })
    });

    $(document).ready(
            $('#name-input-form').submit(function (event) {

                event.preventDefault();
                /* var name = null, surname = null;
                 $('#name-input-form').find('input[type=text]').each(function () {
                 if($(this).name == 'name') name = $(this).name;
                 else surname = $(this).name;
                 });*/
                var formData = {};
                $('#name-input-form').serializeArray().forEach(function (el) {
                    if(el.name == 'name') formData.name = el.value;
                    if(el.name == 'surname') formData.surname = el.value;
                });
                document.cookie = 'name=' + formData.name + ' ' + formData.surname + ';';
                EnableVisualisationRedirectButtons();
                formData.mode = 'names';
                formData.name = formData.surname + ' ' + formData.name;
                console.log('Fetching with formData: ');
                console.log(formData);
                $.post("retrieve", formData, function( data ) {
                    console.log(data);
                    data = JSON.parse(data);
                    // var selectForm = $('#name-select-form');
                    var listHeader = $('#name-select-list-header');
                    data = data.slice(0, 5).reverse();
                    data.forEach(function (name, index) {
                        name = name.split(' ')[1] + ' ' + name.split(' ')[0];
                        var listElement =
                                $(  '<li class="collection-item">' +
                                        '<input name="true_name" type="radio" id="' + index + '">' +
                                        '<label for="' + index + '">' + name + '</label></li>' );
                        listHeader.after(listElement);
                    });
                    $('#name-select-card').attr("hidden", false)

                });
            })
    );

    function EnableVisualisationRedirectButtons() {
        $('.vis-redirect').prop('disabled', false)
    }
</script>
</body>
</html>